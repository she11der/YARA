rule BINARYALERT_Hacktool_Macos_Exploit_Tpwn
{
	meta:
		description = "tpwn exploits a null pointer dereference in XNU to escalate privileges to root."
		author = "@mimeframe"
		id = "b69c4e1c-554e-5553-9b21-6cdf33aff24e"
		date = "2017-09-14"
		modified = "2017-09-14"
		reference = "https://www.rapid7.com/db/modules/exploit/osx/local/tpwn"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_exploit_tpwn.yara#L1-L14"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f864d8c137746edd50526b1d3d95a7335f776cf1473d2d2ea28856dbc515dd9f"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "[-] Couldn't find a ROP gadget, aborting." wide ascii
		$a2 = "leaked kaslr slide," wide ascii
		$a3 = "didn't get root, but this system is vulnerable." wide ascii
		$a4 = "Escalating privileges! -qwertyoruiop" wide ascii

	condition:
		2 of ($a*)
}