rule BINARYALERT_Malware_Windows_Moonlightmaze_Wipe___FILE
{
	meta:
		description = "Rule to detect log cleaner based on wipe.c"
		author = "Kaspersky Lab"
		id = "35060c3d-b805-54a6-a241-eb6e99168fa8"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "http://www.afn.org/~afn28925/wipe.c"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_wipe.yara#L3-L18"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "e69efc504934551c6a77b525d5343241"
		logic_hash = "0241d1ca9f5a4d066f7ed2e80bc18ebae3723c6a2364422e31909e8f0e576675"
		score = 75
		quality = 80
		tags = "FILE"

	strings:
		$a1 = "ERROR: Unlinking tmp WTMP file."
		$a2 = "USAGE: wipe [ u|w|l|a ] ...options..."
		$a3 = "Erase acct entries on tty :   wipe a [username] [tty]"
		$a4 = "Alter lastlog entry       :   wipe l [username] [tty] [time] [host]"

	condition:
		( uint32(0)==0x464c457f) and (2 of them )
}