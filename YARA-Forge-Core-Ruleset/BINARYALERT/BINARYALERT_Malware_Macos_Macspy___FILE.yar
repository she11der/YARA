rule BINARYALERT_Malware_Macos_Macspy___FILE
{
	meta:
		description = "macSpy is a malware-as-a-service (MaaS) product advertised as the most sophisticated Mac spyware ever"
		author = "AlienVault Labs"
		id = "5f9a5ed5-a982-552c-a6df-326228eaf459"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://www.alienvault.com/blogs/labs-research/macspy-os-x-rat-as-a-service"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_macspy.yara#L3-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "6c03e4a9bcb9afaedb7451a33c214ae4"
		logic_hash = "f04648860c9602e43516113000908008847dacfbe189d79e13737bcd034b68a0"
		score = 75
		quality = 80
		tags = "FILE"

	strings:
		$header0 = {cf fa ed fe}
		$header1 = {ce fa ed fe}
		$header2 = {ca fe ba be}
		$c1 = { 76 31 09 00 76 32 09 00 76 33 09 00 69 31 09 00 69 32 09 00 69 33 09 00 69 34 09 00 66 31 09 00 66 32 09 00 66 33 09 00 66 34 09 00 74 63 3A 00 }

	condition:
		($header0 at 0 or $header1 at 0 or $header2 at 0) and $c1
}