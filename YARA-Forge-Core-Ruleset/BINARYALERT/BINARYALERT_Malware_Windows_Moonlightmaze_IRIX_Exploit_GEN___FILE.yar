rule BINARYALERT_Malware_Windows_Moonlightmaze_IRIX_Exploit_GEN___FILE
{
	meta:
		description = "Rule to detect Irix exploits from David Hedley used by Moonlight Maze hackers"
		author = "Kaspersky Lab"
		id = "4f9ab7b0-4fb9-5311-ae23-01d0a9e2e104"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://www.exploit-db.com/exploits/19274/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_IRIX_exploit_GEN.yara#L3-L20"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "9d55d780c84f2aa4e64c19842b2055ef4bf7c8844ebe622c3942445b06ab8344"
		score = 75
		quality = 80
		tags = "FILE"
		md5_1 = "008ea82f31f585622353bd47fa1d84be"
		md5_2 = "a26bad2b79075f454c83203fa00ed50c"
		md5_3 = "f67fc6e90f05ba13f207c7fdaa8c2cab"
		md5_4 = "5937db3896cdd8b0beb3df44e509e136"
		md5_5 = "f4ed5170dcea7e5ba62537d84392b280"

	strings:
		$a1 = "stack = 0x%x, targ_addr = 0x%x"
		$a2 = "execl failed"

	condition:
		( uint32(0)==0x464c457f) and ( all of them )
}