rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "1527f5e3-071d-5152-9452-9c4472d258f2"
		date = "2023-06-03"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/vuln_moveit_0day_jun23.yar#L58-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "56328d078801a702ad47f01f356df6f00be8da593d03c549e77312af9b47b5be"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36" ascii
		$a2 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36" ascii
		$s1 = " POST /moveitisapi/moveitisapi.dll" ascii
		$s2 = " POST /guestaccess.aspx"
		$s3 = " POST /api/v1/folders/"
		$s4 = "/files uploadType=resumable&"
		$s5 = " action=m2 "

	condition:
		1 of ($a*) and 3 of ($s*) or all of ($s*)
}