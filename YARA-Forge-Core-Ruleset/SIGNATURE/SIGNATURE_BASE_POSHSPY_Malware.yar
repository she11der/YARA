rule SIGNATURE_BASE_POSHSPY_Malware
{
	meta:
		description = "Detects"
		author = "Florian Roth (Nextron Systems)"
		id = "7e908efc-0023-5be1-9871-8bfbf8b9e53a"
		date = "2017-07-15"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/apt_poshspy.yar#L11-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "e1f8b502950d2f7600041b5492f529682b9f5f2863c36ad40618b5ed78a94567"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "function sWP($cN, $pN, $aK, $aI)" fullword ascii
		$x2 = "$aeK = [byte[]] (0x69, 0x87, 0x0b, 0xf2" ascii
		$x3 = "(('variant', 'excretions', 'accumulators', 'winslow', 'whistleable', 'len',"
		$x4 = "$cPairKey = \"BwIAAACkAABSU0EyAAQAAAEAA"
		$x5 = "$exeRes = exePldRoutine"
		$x6 = "ZgB1AG4AYwB0AGkAbwBuACAAcAB1AHIAZgBDAHIA"

	condition:
		1 of them
}