rule SIGNATURE_BASE_Malware_Sakula_Shellcode
{
	meta:
		description = "Sakula shellcode - taken from decoded setup.msi but may not be unique enough to identify Sakula"
		author = "David Cannings"
		id = "147e4894-7877-5367-9f6b-588eb7f0379a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/apt_sakula.yar#L47-L80"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "0e84d91cd1bb0455ac7d2ca78583510388f39cebd95523c5f6f173a50e0c1951"
		score = 75
		quality = 85
		tags = ""

	strings:
		$opcodes01 = { 55 89 E5 E8 00 00 00 00 58 83 C0 06 C9 C3 }
		$opcodes02 = { 8B 5E 3C 8B 5C 1E 78 8B 4C 1E 20 53 8B 5C 1E 24 01 F3 }

	condition:
		any of them
}