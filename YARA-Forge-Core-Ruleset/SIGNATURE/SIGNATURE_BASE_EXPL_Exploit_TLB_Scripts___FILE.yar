rule SIGNATURE_BASE_EXPL_Exploit_TLB_Scripts___FILE
{
	meta:
		description = "Detects malicious TLB files which may be delivered via Visual Studio projects"
		author = "Rich Warren (slightly modified by Florian Roth)"
		id = "5151458e-4c30-50ff-a39e-e5b5b68b87aa"
		date = "2021-01-26"
		modified = "2023-12-05"
		reference = "https://github.com/outflanknl/Presentations/blob/master/Nullcon2020_COM-promise_-_Attacking_Windows_development_environments.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/exploit_tlb_scripts.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "39bf626d60a867d054762043f74e86998d6848439655f84be72003c112db9953"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$a = ".sct" ascii nocase
		$b = "script:" ascii nocase
		$c = "scriptlet:" ascii nocase
		$d = "soap:" ascii nocase
		$e = "winmgmts:" ascii nocase

	condition:
		uint32be(0)==0x4D534654 and filesize <100KB and any of them
}