rule SIGNATURE_BASE_Unspecified_Malware_Jul17_1A___FILE
{
	meta:
		description = "Detects samples of an unspecified malware - July 2017"
		author = "Florian Roth (Nextron Systems)"
		id = "348515d5-784f-519d-b426-87b8a53de5f3"
		date = "2017-07-07"
		modified = "2023-12-05"
		reference = "Winnti HDRoot VT"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/apt_winnti_hdroot.yar#L66-L83"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "e23af53be3e700055ea6536669065c131e7f674d45e43a389447c8c1f549dee5"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e1c38142b6194237a4cd4603829aa6edb6436e7bba15e3e6b0c9e8c6b629b42b"

	strings:
		$s1 = "%SystemRoot%\\System32\\wuauserv.dll" fullword ascii
		$s2 = "systemroot%\\system32\\wuauserv.dll" fullword ascii
		$s3 = "ocgen.logIN" fullword wide
		$s4 = "ocmsn.logIN" fullword wide
		$s5 = "Install.log" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <900KB and all of them )
}