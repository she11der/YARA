rule SIGNATURE_BASE_Cobaltgang_Malware_Aug17_1___FILE
{
	meta:
		description = "Detects a Cobalt Gang malware"
		author = "Florian Roth (Nextron Systems)"
		id = "56c6f4f8-ccf5-5665-ac21-67f0a9b67cf1"
		date = "2017-08-09"
		modified = "2023-12-05"
		reference = "https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/crime_cobaltgang.yar#L41-L57"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "46077106bd19dd38a714a220b887742f5a29424ac8eb89f469975f863b3782ec"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "6d70673b723f338b3febc9f1d69463bdd4775539cb92b5a5d8fccc0d977fa2f0"

	strings:
		$s1 = "ServerSocket.EXE" fullword wide
		$s2 = "Incorrect version of WS2_32.dll found" fullword ascii
		$s3 = "Click 'Connect' to Connect to the Server.  'Disconnect' to disconnect from server." fullword wide
		$s4 = "Click 'Start' to start the Server.  'Stop' to Stop it." fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <400KB and 3 of them )
}