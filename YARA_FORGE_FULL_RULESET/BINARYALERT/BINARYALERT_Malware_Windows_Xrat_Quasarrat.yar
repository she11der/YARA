rule BINARYALERT_Malware_Windows_Xrat_Quasarrat
{
	meta:
		description = "xRAT is a derivative of QuasarRAT; this catches both RATs."
		author = "@mimeframe"
		id = "f4db2402-3653-5525-a137-de2de29cef28"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/quasar/QuasarRAT"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_xrat_quasarrat.yara#L1-L31"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "92533157a62ccae5d1bdc9d0bb7511817422c6b5d75d013a15173cd1121d099e"
		score = 75
		quality = 30
		tags = ""

	strings:
		$a1 = ">> New Session created" wide ascii
		$a2 = ">> Session unexpectedly closed" wide ascii
		$a3 = ">> Session closed" wide ascii
		$a4 = "session unexpectedly closed" wide ascii
		$a5 = "cmd" fullword wide ascii
		$a6 = "/K" fullword wide ascii
		$b1 = "echo DONT CLOSE THIS WINDOW!" wide ascii
		$b2 = "ping -n 20 localhost > nul" wide ascii
		$b3 = "Downloading file..." wide ascii
		$b4 = "Visited Website" wide ascii
		$b5 = "Adding Autostart Item failed!" wide ascii
		$b6 = ":Zone.Identifier" wide ascii
		$c1 = "GetDrives I/O error" wide ascii
		$c2 = "/r /t 0" wide ascii
		$c3 = "desktop.ini" wide ascii
		$c4 = "WAN IP Address" wide ascii
		$c5 = "User refused the elevation request." wide ascii
		$c6 = "Process already elevated." wide ascii

	condition:
		5 of ($a*) or 5 of ($b*) or 5 of ($c*)
}
