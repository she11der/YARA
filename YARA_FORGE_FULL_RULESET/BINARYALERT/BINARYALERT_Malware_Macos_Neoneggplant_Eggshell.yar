rule BINARYALERT_Malware_Macos_Neoneggplant_Eggshell
{
	meta:
		description = "EggShell is an iOS and macOS post exploitation surveillance pentest tool written in Python."
		author = "@mimeframe"
		id = "274a34cc-9403-50e6-aa64-683a41bc30e6"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/neoneggplant/EggShell"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_neoneggplant_eggshell.yara#L1-L24"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "34906db9398313ccb84e67bd98e94324c628aefe3efa6ba3cca2df042b42cbe7"
		score = 50
		quality = 80
		tags = ""

	strings:
		$a1 = "Created By Lucas Jackson (@neoneggplant)" wide ascii
		$a2 = "SET LHOST (Leave blank for" wide ascii
		$a3 = "SET LPORT (Leave blank for" wide ascii
		$b1 = "/tmp/.esplog" wide ascii
		$b2 = "spGHbigdxMBJpbOCAr3rnS3inCdYQyZV" wide ascii
		$b3 = "keylogclear" wide ascii
		$b4 = "getpasscode" wide ascii
		$c1 = "spGHbigdxMBJpbOCAr3rnS3inCdYQyZV" wide ascii
		$c2 = "getfacebook" wide ascii
		$c3 = "type is eggsu" wide ascii
		$c4 = "rmpersistence" wide ascii

	condition:
		all of ($a*) or 3 of ($b*) or 3 of ($c*)
}
