rule SIGNATURE_BASE_Passcv_Sabre_Malware_3 : FILE
{
	meta:
		description = "PassCV Malware mentioned in Cylance Report"
		author = "Florian Roth (Nextron Systems)"
		id = "03e5efc0-6076-501f-a600-b3d9008a8711"
		date = "2016-10-20"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_passcv.yar#L107-L124"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "1032f41688e7cb3fe0be33b143c1af43ee705737a70af3b336ba8504ffe169a9"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "28c7575b2368a9b58d0d1bf22257c4811bd3c212bd606afc7e65904041c29ce1"

	strings:
		$x1 = "NXKILL" fullword wide
		$s1 = "2OLE32.DLL" fullword ascii
		$s2 = "localspn.dll" fullword wide
		$s3 = "!This is a Win32 program." fullword ascii

	condition:
		( uint16(0)==0x5a4d and filesize <8000KB and $x1 and 2 of ($s*))
}
