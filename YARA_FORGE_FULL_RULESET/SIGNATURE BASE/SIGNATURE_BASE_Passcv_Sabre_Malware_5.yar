rule SIGNATURE_BASE_Passcv_Sabre_Malware_5 : FILE
{
	meta:
		description = "PassCV Malware mentioned in Cylance Report"
		author = "Florian Roth (Nextron Systems)"
		id = "ce8d1b9e-7750-5796-a048-20bfd48c6aee"
		date = "2016-10-20"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_passcv.yar#L161-L182"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "30508c6561a2bb908945e9092da1d5cf2257b8b183effcea25a1ba15567f3d20"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "03aafc5f468a84f7dd7d7d38f91ff17ef1ca044e5f5e8bbdfe589f5509b46ae5"

	strings:
		$x1 = "ncircTMPg" fullword ascii
		$x2 = "~SHELL#" fullword ascii
		$x3 = "N.adobe.xm" fullword ascii
		$s1 = "NEL32.DLL" fullword ascii
		$s2 = "BitLocker.exe" fullword wide
		$s3 = "|xtplhd" fullword ascii
		$s4 = "SERVICECORE" fullword wide
		$s5 = "SHARECONTROL" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <4000KB and 1 of ($x*) or all of ($s*))
}
