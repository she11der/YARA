rule SIGNATURE_BASE_Malware_QA_Tls : FILE
{
	meta:
		description = "VT Research QA uploaded malware - file tls.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "b3b654b1-73cf-5e04-a332-34777f646a66"
		date = "2016-08-29"
		modified = "2023-12-05"
		reference = "VT Research QA"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/gen_malware_set_qa.yar#L71-L87"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "20c849d8c60acd77a28244c7ebcbb2f96b233e74af6c52112a0c828e1de2ed84"
		score = 80
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "f06d1f2bee2eb6590afbfa7f011ceba9bd91ba31cdc721bc728e13b547ac9370"

	strings:
		$s1 = "\\funoverip\\ultimate-payload-template1\\" ascii
		$s2 = "ULTIMATEPAYLOADTEMPLATE1" fullword wide
		$s3 = "ultimate-payload-template1" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <300KB and 1 of them ) or ( all of them )
}
