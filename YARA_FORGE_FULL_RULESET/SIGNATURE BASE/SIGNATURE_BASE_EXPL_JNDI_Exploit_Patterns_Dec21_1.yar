rule SIGNATURE_BASE_EXPL_JNDI_Exploit_Patterns_Dec21_1
{
	meta:
		description = "Detects JNDI Exploit Kit patterns in files"
		author = "Florian Roth (Nextron Systems)"
		id = "a9127dd2-b818-5ca8-877a-3c47b1e92606"
		date = "2021-12-12"
		modified = "2023-12-05"
		reference = "https://github.com/pimps/JNDI-Exploit-Kit"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/expl_log4j_cve_2021_44228.yar#L16-L49"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "9442c8c4eee76539892752361657c86e80acc7990876e787317b042a4637f669"
		score = 60
		quality = 85
		tags = ""

	strings:
		$x01 = "/Basic/Command/Base64/"
		$x02 = "/Basic/ReverseShell/"
		$x03 = "/Basic/TomcatMemshell"
		$x04 = "/Basic/JettyMemshell"
		$x05 = "/Basic/WeblogicMemshell"
		$x06 = "/Basic/JBossMemshell"
		$x07 = "/Basic/WebsphereMemshell"
		$x08 = "/Basic/SpringMemshell"
		$x09 = "/Deserialization/URLDNS/"
		$x10 = "/Deserialization/CommonsCollections1/Dnslog/"
		$x11 = "/Deserialization/CommonsCollections2/Command/Base64/"
		$x12 = "/Deserialization/CommonsBeanutils1/ReverseShell/"
		$x13 = "/Deserialization/Jre8u20/TomcatMemshell"
		$x14 = "/TomcatBypass/Dnslog/"
		$x15 = "/TomcatBypass/Command/"
		$x16 = "/TomcatBypass/ReverseShell/"
		$x17 = "/TomcatBypass/TomcatMemshell"
		$x18 = "/TomcatBypass/SpringMemshell"
		$x19 = "/GroovyBypass/Command/"
		$x20 = "/WebsphereBypass/Upload/"
		$fp1 = "<html"

	condition:
		1 of ($x*) and not 1 of ($fp*)
}
