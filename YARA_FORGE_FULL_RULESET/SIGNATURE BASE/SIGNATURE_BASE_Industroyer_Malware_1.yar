rule SIGNATURE_BASE_Industroyer_Malware_1 : FILE
{
	meta:
		description = "Detects Industroyer related malware"
		author = "Florian Roth (Nextron Systems)"
		id = "f5ab571c-03a7-538a-ada1-0930d15af5cf"
		date = "2017-06-13"
		modified = "2023-12-05"
		reference = "https://goo.gl/x81cSy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_industroyer.yar#L12-L37"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "276b7abdf43b62c3943a8dc362e1c68b23cc505d288e4395a6ac3cb4795371f2"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ad23c7930dae02de1ea3c6836091b5fb3c62a89bf2bcfb83b4b39ede15904910"
		hash2 = "018eb62e174efdcdb3af011d34b0bf2284ed1a803718fba6edffe5bc0b446b81"

	strings:
		$s1 = "haslo.exe" fullword ascii
		$s2 = "SYSTEM\\CurrentControlSet\\Services\\%ls" fullword wide
		$s3 = "SYS_BASCON.COM" fullword wide
		$s4 = "*.pcmt" fullword wide
		$s5 = "*.pcmi" fullword wide
		$x1 = { 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73
         00 5C 00 25 00 6C 00 73 00 00 00 49 00 6D 00 61
         00 67 00 65 00 50 00 61 00 74 00 68 00 00 00 43
         00 3A 00 5C 00 00 00 44 00 3A 00 5C 00 00 00 45
         00 3A 00 5C 00 00 00 }
		$x2 = "haslo.dat\x00Crash"

	condition:
		( uint16(0)==0x5a4d and filesize <200KB and 1 of ($x*) or 2 of them )
}
