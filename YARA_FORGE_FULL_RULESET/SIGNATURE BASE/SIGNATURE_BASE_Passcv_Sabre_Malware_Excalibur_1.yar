rule SIGNATURE_BASE_Passcv_Sabre_Malware_Excalibur_1 : FILE
{
	meta:
		description = "PassCV Malware mentioned in Cylance Report"
		author = "Florian Roth (Nextron Systems)"
		id = "eadad36c-49c8-50e1-8334-813d2e760fe9"
		date = "2016-10-20"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_passcv.yar#L84-L105"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "ffbd971368420460573c4ecc68261088ffacf91ab9ae72405b41393b04aa2b46"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "21566f5ff7d46cc9256dae8bc7e4c57f2b9261f95f6ad2ac921558582ea50dfb"
		hash2 = "02922c5d994e81629d650be2a00507ec5ca221a501fe3827b5ed03b4d9f4fb70"

	strings:
		$x1 = "F:\\Excalibur\\Excalibur\\" ascii
		$x2 = "Excalibur\\bin\\Shell.pdb" ascii
		$x3 = "SaberSvc.exe" wide
		$s1 = "BBB.exe" fullword wide
		$s2 = "AAA.exe" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <2000KB and 1 of ($x*) or all of ($s*)) or 3 of them
}
