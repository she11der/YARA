rule SIGNATURE_BASE_Bladabindi_Malware_B64 : FILE
{
	meta:
		description = "Detects Bladabindi Malware using Base64 encoded strings"
		author = "Florian Roth (Nextron Systems)"
		id = "7f7023be-b6e1-5e1b-af8a-c413a5438ec8"
		date = "2016-10-08"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/crime_malware_set_oct16.yar#L91-L108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "081a6361e29fc231f1467b837c51a39b8cccf8caa20844b22d469ce2bbd0c7fb"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "dda668b0792b7679979e61f2038cf9a8ec39415cc161be00d2c8301e7d48768d"

	strings:
		$s1 = "XHN5c3RlbTMyXA==" fullword ascii
		$s2 = "RXhlY3V0ZSBFUlJPUg==" fullword ascii
		$s3 = "dHJvamFuLmV4ZQ==" fullword ascii
		$s4 = "VXBkYXRlIEVSUk9S" fullword ascii
		$s5 = "RG93bmxvYWQgRVJST1I=" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <700KB and 1 of them
}
