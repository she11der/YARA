rule SIGNATURE_BASE_Malware_Msupdater_String_In_EXE : FILE
{
	meta:
		description = "MSUpdater String in Executable"
		author = "Florian Roth (Nextron Systems)"
		id = "c7da9e1e-3a8d-54b6-b102-0e1095d99cc4"
		date = "2015-06-03"
		modified = "2023-12-05"
		reference = "VT Analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_putterpanda.yar#L133-L156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		hash = "b1a2043b7658af4d4c9395fa77fde18ccaf549bb"
		logic_hash = "2b7a43aee6dbac1bfa7d9e0331cb078394ae78a1ec44c1a4a70a63b38595abe0"
		score = 50
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "msupdate.exe" fullword wide
		$x3 = "msupdater.exe" fullword ascii
		$x4 = "msupdater32.exe" fullword ascii
		$x5 = "msupdater32.exe" fullword wide
		$x6 = "msupdate.pif" fullword ascii
		$fp1 = "_msupdate_" wide
		$fp2 = "_msupdate_" ascii
		$fp3 = "/kies" wide

	condition:
		uint16(0)==0x5a4d and filesize <500KB and (1 of ($x*)) and not (1 of ($fp*))
}
