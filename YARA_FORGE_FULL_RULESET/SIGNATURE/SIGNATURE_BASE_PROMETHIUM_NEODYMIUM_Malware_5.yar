rule SIGNATURE_BASE_PROMETHIUM_NEODYMIUM_Malware_5 : FILE
{
	meta:
		description = "Detects PROMETHIUM and NEODYMIUM malware"
		author = "Florian Roth (Nextron Systems)"
		id = "4bd60f61-a595-5289-9595-a7e33f265748"
		date = "2016-12-14"
		modified = "2023-12-05"
		reference = "https://goo.gl/8abDE6"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_promethium_neodymium.yar#L87-L105"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "69433fae4d51f7fd7b6f5b683f9c751d0f0352b8ed805a8177085e635eb26260"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a8b7e3edaa18c6127e98741503c3a2a66b7720d2abd967c94b8a5f2e99575ac5"

	strings:
		$s1 = "Winxsys.exe" fullword wide
		$s2 = "%s\\ssleay32.dll" fullword wide
		$s3 = "%s\\libeay32.dll" fullword wide
		$s4 = "Windows Index Services" fullword wide
		$s5 = "<F RAT" fullword ascii
		$s6 = "WININDX-088FA840-B10D-11D3-BC36-006067709674" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <5000KB and 3 of them )
}
