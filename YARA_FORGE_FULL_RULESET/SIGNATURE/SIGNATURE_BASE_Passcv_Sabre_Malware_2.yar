rule SIGNATURE_BASE_Passcv_Sabre_Malware_2 : FILE
{
	meta:
		description = "PassCV Malware mentioned in Cylance Report"
		author = "Florian Roth (Nextron Systems)"
		id = "dd9eb5f6-9faa-584d-b3b5-6dcfdc3f359c"
		date = "2016-10-20"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/apt_passcv.yar#L59-L82"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "f640f1dc60c6714195dcdb9a0bb4fb0c34e0a62673bca00c7f49f7b73c3f9b0a"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "475d1c2d36b2cf28b28b202ada78168e7482a98b42ff980bbb2f65c6483db5b4"
		hash2 = "009645c628e719fad2e280ef60bbd8e49bf057196ac09b3f70065f1ad2df9b78"
		hash3 = "92479c7503393fc4b8dd7c5cd1d3479a182abca3cda21943279c68a8eef9c64b"
		hash4 = "0c7b952c64db7add5b8b50b1199fc7d82e9b6ac07193d9ec30e5b8d353b1f6d2"

	strings:
		$x1 = "ncProxyXll" fullword ascii
		$s1 = "Uniscribe.dll" fullword ascii
		$s2 = "WS2_32.dll" ascii
		$s3 = "ProxyDll" fullword ascii
		$s4 = "JDNSAPI.dll" fullword ascii
		$s5 = "x64.dat" fullword ascii
		$s6 = "LSpyb2" fullword ascii

	condition:
		( uint16(0)==0x5a4d and filesize <4000KB and $x1) or ( all of them )
}
