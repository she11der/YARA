rule SIGNATURE_BASE_Unspecified_Malware_Oct16_D : FILE
{
	meta:
		description = "Detects unspecified malware - October 2016"
		author = "Florian Roth (Nextron Systems)"
		id = "6908467c-1ed6-508d-9503-246dd26823e5"
		date = "2016-10-08"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/yara/crime_malware_set_oct16.yar#L131-L150"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c04cde449bdf5fb40bb001fb663d32a70f89abe4/LICENSE"
		logic_hash = "78cde422987d2aff64967b86b6cf9279c112a2bfb713a2ea40fe952379d2e326"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "cd5f3bc0176a6803093ffdea6a7442c416e0d2945b6903063d17f5bb8d17519d"

	strings:
		$s1 = "C:\\file.exe" fullword wide
		$s2 = "new.exe" fullword wide
		$s3 = "passwordIterations" fullword ascii
		$op0 = { 10 00 12 00 1a 00 05 00 01 00 01 00 01 00 10 00 }
		$op1 = { 41 32 00 36 00 62 00 34 00 32 00 65 00 37 00 62 }
		$op2 = { 3c 4d 6f 64 75 6c 65 3e 00 6e 65 77 2e 65 78 65 }

	condition:
		uint16(0)==0x5a4d and filesize <1000KB and ( all of ($s*) or all of ($op*))
}
