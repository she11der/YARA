import "pe"

rule DITEKSHEN_MALWARE_Win_TOITOIN_Injectordll : FILE
{
	meta:
		description = "Detects TOITOIN InjectorDLL"
		author = "ditekSHen"
		id = "40776e0a-29df-52ea-8486-35027ab31a1b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L11145-L11157"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "fc80c702305657ba1058ca7f55579d1d5254dd0f619c5f7fda7886a868b65c93"
		score = 75
		quality = 25
		tags = "FILE"
		clamav = "ditekSHen.MALWARE.Win.Trojan.TOITOIN"

	strings:
		$p1 = ":\\Trabalho_2023\\OFF_2023\\" ascii
		$p2 = "DLL_START_IN.pdb" ascii
		$s1 = ".ini" fullword ascii
		$s2 = "\\users\\Public\\Documents\\" fullword ascii

	condition:
		uint16(0)==0x5a4d and (1 of ($p*) and all of ($s*))
}
