import "pe"

rule DITEKSHEN_MALWARE_Win_Arrowrat : FILE
{
	meta:
		description = "Detects ArrowRAT"
		author = "ditekSHen"
		id = "14d3aabe-1ef5-599f-adbd-61b580099447"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L9959-L9977"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "13e6d4fd274f75c50aa4110276812d02885c03cfc269dde480db66955e5f703a"
		score = 75
		quality = 25
		tags = "FILE"

	strings:
		$s1 = "29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb" wide
		$s2 = "Software\\Classes\\ms-settings\\shell\\open\\command" wide
		$s3 = "DelegateExecute" fullword wide
		$s4 = "powershell" wide
		$s5 = "DESKTOP_HOOKCONTROL" fullword ascii
		$s6 = "PROCESS_INFORMATION" fullword ascii
		$s7 = "STARTUP_INFORMATION" fullword ascii
		$s8 = /(Venom|Pandora)\shVNC/ fullword wide
		$s9 = "cmd.exe /k START" fullword wide
		$s10 = "ExclusionWD" fullword ascii
		$s11 = "WinExec" fullword ascii

	condition:
		uint16(0)==0x5a4d and 5 of them
}
