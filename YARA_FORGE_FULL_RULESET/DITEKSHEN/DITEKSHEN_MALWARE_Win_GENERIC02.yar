import "pe"

rule DITEKSHEN_MALWARE_Win_GENERIC02 : FILE
{
	meta:
		description = "Detects known unamed malicious executables"
		author = "ditekSHen"
		id = "d0d24e69-0e99-5766-8e8e-9cdce902fa8f"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L4577-L4591"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "4f750c871ee061ed2d5d1f68e6ac1f56b8127321cfc207e2dd1dbed9d9848ce5"
		score = 75
		quality = 25
		tags = "FILE"

	strings:
		$s1 = "{%s-%d-%d}" fullword wide
		$s2 = "update" fullword wide
		$s3 = "https://" fullword wide
		$s4 = "http://" fullword wide
		$s5 = "configure" fullword ascii
		$s6 = { 8d 4f 02 e8 8c ff ff ff 8b d8 81 fb 00 dc 00 00 }
		$s7 = { 83 c1 02 e8 3c ff ff ff 8b c8 ba ff 03 00 00 8d }

	condition:
		uint16(0)==0x5a4d and all of them
}
