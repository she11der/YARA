import "pe"

rule DITEKSHEN_MALWARE_Win_Karaganykeylogger : FILE
{
	meta:
		description = "Detects Karagany/xFrost keylogger plugin"
		author = "ditekSHen"
		id = "dd14ede0-7132-5b7f-872a-d96d5275a8e4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L3029-L3041"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "7f1f5b2ca67e62380c8a8095fed4a4fd76d7bc15c9fe2d76e780ad85f886ef7b"
		score = 75
		quality = 23
		tags = "FILE"

	strings:
		$s1 = "__klg__" fullword wide
		$s2 = "__klgkillsoft__" fullword wide
		$s3 = "CLIPBOARD_PASTE" wide
		$s4 = "%s\\k%d.txt" wide
		$s5 = "\\Update\\Tmp" wide

	condition:
		uint16(0)==0x5a4d and 4 of them
}
