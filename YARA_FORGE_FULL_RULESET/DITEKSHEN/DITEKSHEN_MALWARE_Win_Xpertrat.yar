import "pe"

rule DITEKSHEN_MALWARE_Win_Xpertrat : FILE
{
	meta:
		description = "XpertRAT payload"
		author = "ditekSHen"
		id = "cea7de47-b47c-5fea-96ee-5858b16cca8d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L28-L56"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "2a521bd1d6ce16fa16aa7757db2657dcab15e6802454ad899906d4ed17401feb"
		score = 75
		quality = 63
		tags = "FILE"
		snort_sid = "920003-920006"
		clamav_sig = "MALWARE.Win.Trojan.XpertRAT"

	strings:
		$v1 = "[XpertRAT-Mutex]" fullword wide
		$v2 = "XPERTPLUGIN" fullword wide
		$v3 = "+Xpert+3." wide
		$v4 = "keylog.tmp" fullword wide
		$v5 = "\\TempReg.reg" fullword wide
		$s1 = "ClsKeylogger" fullword ascii nocase
		$s2 = "clsCamShot" fullword ascii nocase
		$s3 = "ClsShellCommand" fullword ascii nocase
		$s4 = "ClsRemoteDesktop" fullword ascii nocase
		$s5 = "ClsScreenRemote" fullword ascii nocase
		$s6 = "ClsSoundRemote" fullword ascii nocase
		$s7 = "MdlHidder" fullword ascii
		$s8 = "modKeylog" fullword ascii
		$s9 = "modWipe" fullword ascii
		$s10 = "modDelProcInUse" fullword ascii
		$s11 = "Socket_DataArrival" fullword ascii
		$s12 = "cZip_EndCompress" fullword ascii

	condition:
		uint16(0)==0x5a4d and (3 of ($v*) or 6 of ($s*))
}
