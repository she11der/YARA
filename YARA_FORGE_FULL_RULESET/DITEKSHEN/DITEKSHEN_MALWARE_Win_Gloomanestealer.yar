import "pe"

rule DITEKSHEN_MALWARE_Win_Gloomanestealer : FILE
{
	meta:
		description = "Detects GloomaneStealer"
		author = "ditekSHen"
		id = "6e3c7e8f-4b75-5198-aa41-076f29aac227"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L9461-L9477"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "36aa9f863efb8172ed6449932169e6cb26cdeedd84bc734e09a8116a9c7774ac"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$x1 = "=GLOOMANE STEALER=" wide
		$x2 = "Maded by GLOOMANE" wide
		$s1 = "\\44CALIBER" ascii
		$s2 = "Ethernet()" fullword wide
		$s3 = ":spy: NEW LOG FROM" wide
		$s4 = ":eye: IP:" wide
		$s5 = ":file_folder: Grabbed Files" wide
		$s6 = "$ebc25cf6-9120-4283-b972-0e5520d0000C" fullword ascii
		$s7 = "$3b0e2d3d-3d66-42bb-8f9c-d6e188f359ae" fullword ascii

	condition:
		uint16(0)==0x5a4d and ( all of ($x*) or (1 of ($x*) and 3 of ($s*)) or 5 of ($s*))
}
