import "pe"

rule DITEKSHEN_MALWARE_Win_Dlinjector03 : FILE
{
	meta:
		description = "Detects unknown loader / injector"
		author = "ditekSHen"
		id = "2d0df2d8-5b1c-5408-b8c7-8ca14d57da0f"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L6541-L6551"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "10092e7916775fe0a39baa5714fdda89f443ceabdcc610cc1fcd5a0fb0e68d0c"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$x1 = "LOADER ERROR" fullword ascii
		$s1 = "_ZN6curlpp10OptionBaseC2E10CURLoption" fullword ascii
		$s2 = "The procedure entry point %s could not be located in the dynamic link library %s" fullword ascii

	condition:
		uint16(0)==0x5a4d and all of them
}
