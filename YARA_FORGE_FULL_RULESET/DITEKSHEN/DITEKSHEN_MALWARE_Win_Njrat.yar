import "pe"

rule DITEKSHEN_MALWARE_Win_Njrat : FILE
{
	meta:
		description = "Detects NjRAT / Bladabindi / NjRAT Golden"
		author = "ditekSHen"
		id = "078dea64-8f95-5939-a1fb-c0a888adcf0d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L5203-L5220"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "92d535a7c7f361b7a0901d0b99427ebc82a69577bfea73c04a7f9d51d2054b36"
		score = 75
		quality = 25
		tags = "FILE"

	strings:
		$x1 = /Njrat\s\d+\.\d+\sGolden\s/ wide
		$s1 = /\sfirewall\s(add|delete)\sallowedprogram/ wide
		$s2 = { 63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 20 00 2f 00 (63|6b) 00 20 00 70 00 69 00 6e 00 67 }
		$s3 = "Execute ERROR" wide
		$s4 = "Download ERROR" wide
		$s5 = "[kl]" fullword wide
		$s6 = "UploadValues" fullword wide
		$s7 = "winmgmts:\\\\.\\root\\SecurityCenter2" fullword wide
		$s8 = "HideM" fullword wide
		$s9 = "No Antivirus" fullword wide

	condition:
		uint16(0)==0x5a4d and 4 of them
}
