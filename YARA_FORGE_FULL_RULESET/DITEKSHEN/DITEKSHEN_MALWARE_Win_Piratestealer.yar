import "pe"

rule DITEKSHEN_MALWARE_Win_Piratestealer : FILE
{
	meta:
		description = "Detects PirateStealer"
		author = "ditekSHen"
		id = "07278b99-b990-5016-8389-fbd27538a722"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L8624-L8642"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "c29fbc6cfa9e529218fa7315481e0922dc10b2da729931b8580bdd76ecdf6b68"
		score = 50
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "PirateStealerBTW" wide
		$s2 = "/PirateStealer/main/src/" wide
		$s3 = "%WEBHOOK_LINK%" fullword wide
		$s4 = "your_webhook_here" fullword wide
		$s5 = "PirateMonsterInjector" ascii wide
		$s6 = "DiscordProcesses" fullword ascii
		$s7 = "GetDiscords" fullword ascii
		$s8 = { 44 6f 77 6e 6c 6f 61 64 53 74 72 69 6e 67 00 47
               65 74 46 6f 6c 64 65 72 50 61 74 68 00 57 65 62
               68 6f 6f 6b 00 4b 69 6c 6c 00 50 72 6f 67 72 61
               6d 00 53 79 73 74 65 6d 00 4d 61 69 6e 00 }

	condition:
		uint16(0)==0x5a4d and 3 of them
}
