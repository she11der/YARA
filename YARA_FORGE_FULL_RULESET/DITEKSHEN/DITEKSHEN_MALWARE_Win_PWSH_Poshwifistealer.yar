import "pe"

rule DITEKSHEN_MALWARE_Win_PWSH_Poshwifistealer
{
	meta:
		description = "Detects PowerShell PoshWiFiStealer"
		author = "ditekSHen"
		id = "69ac123d-b746-57f1-a488-547f9a9cdd86"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L4754-L4765"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "769349360b5d22226a5339a9e8471d06731dc522475c9385c1c145a0488e0ad1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh wlan export profile" ascii
		$s2 = "Send-MailMessage" ascii
		$u1 = "https://github.com/axel05869/Wifi-Grab" ascii
		$u2 = "/exploitechx/wifi-password-extractor" ascii

	condition:
		all of ($s*) or all of ($u*)
}
