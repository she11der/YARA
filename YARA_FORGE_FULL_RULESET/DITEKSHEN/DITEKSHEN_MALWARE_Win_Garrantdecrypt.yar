import "pe"

rule DITEKSHEN_MALWARE_Win_Garrantdecrypt : FILE
{
	meta:
		description = "Detects GarrantDecrypt ransomware"
		author = "ditekSHen"
		id = "e3be3663-9978-5b8e-b6b2-0f44f269adb2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L9098-L9112"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "84b139e51f0ef0389c641d62409d702b0ae7ec6ecd2fa54baf2cf0c0078a8f5a"
		score = 75
		quality = 25
		tags = "FILE"

	strings:
		$x1 = "%appdata%\\_uninstalling_.png" fullword wide
		$x2 = "C:\\Windows\\sysnative\\vssadmin.exe" fullword wide
		$x3 = /(ICQ|Skype) (@nuncatarde|@supersuso|@Whitehorsedecryption|@likeahorse|@Konwarszawski|@zipzipulya|Whitehorsedecryption|LIKEAHORSE DECRYPTION|Zip Zipulya)/ ascii
		$s1 = "your unique ID" ascii
		$s2 = "Google market ICQ" ascii
		$s3 = "If you want to restore them, install ICQ" ascii
		$s4 = "Write to our ICQ @" ascii

	condition:
		uint16(0)==0x5a4d and ((2 of ($x*) and 1 of ($s*)) or all of ($s*))
}
