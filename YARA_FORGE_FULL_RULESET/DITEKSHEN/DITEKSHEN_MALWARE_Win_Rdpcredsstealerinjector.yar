import "pe"

rule DITEKSHEN_MALWARE_Win_Rdpcredsstealerinjector : FILE
{
	meta:
		description = "Detects RDP Credentials Stealer injector"
		author = "ditekSHen"
		id = "221b7d64-6585-5f3a-bffa-bde05390db73"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L11010-L11023"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "0dfade8dde987f5134158b7c4abc3eaf8dcece86e1ff2ab1da4466da316939a2"
		score = 75
		quality = 25
		tags = "FILE"
		clamav1 = "MALWARE.Win.Trojan.RDPCredsStealer-Injector"

	strings:
		$s1 = "\\APIHookInjectorBin\\" ascii
		$s2 = "\\RDPCredsStealerDLL.dll" ascii
		$s3 = "DLL Injected" ascii
		$s4 = "Code Injected" ascii
		$s5 = /(OpenProcess|VirtualAllocEx|CreateRemoteThread)\(\) failed:/ fullword ascii

	condition:
		uint16(0)==0x5a4d and 3 of them
}
