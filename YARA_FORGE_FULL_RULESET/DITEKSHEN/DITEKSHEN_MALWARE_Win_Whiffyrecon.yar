import "pe"

rule DITEKSHEN_MALWARE_Win_Whiffyrecon : FILE
{
	meta:
		description = "Detects Whiffy Recon"
		author = "ditekSHen"
		id = "19b0f327-06ee-5f78-abac-9c4fbcad98ac"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L11048-L11068"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "58df9f47f5890c5e31d352be682c6164a940dad206ad29c54c43f70d3afb9543"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "WLANSVC" fullword wide
		$s2 = "f02fe1c0-137a-4802-8881-55dd300c5022" fullword wide
		$s3 = "\\wlan.lnk" fullword wide
		$s4 = "str-12.bin" wide
		$s5 = "/geolocation/v1/geolocate?key=" wide
		$s6 = "/wlan" fullword wide
		$s7 = "/scanned" fullword wide
		$s8 = "/bots/" fullword wide
		$s9 = "wlan.pdb" fullword ascii
		$s10 = "botId" fullword ascii
		$s11 = "wifiAccessPoints" fullword ascii
		$s12 = "considerIp" fullword ascii
		$s13 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36" fullword wide

	condition:
		uint16(0)==0x5a4d and 5 of them
}
