import "pe"

rule DITEKSHEN_MALWARE_Win_Cybergate : FILE
{
	meta:
		description = "Detects CyberGate/Spyrat/Rebhip RTA"
		author = "ditekSHen"
		id = "3b50ccfb-6603-5002-8ceb-e9252d4c7dff"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L4008-L4026"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "b4a3c07533c2b251e1a714b28fb0b654c76881fb6ce970f6586c5908ee65609b"
		score = 75
		quality = 46
		tags = "FILE"

	strings:
		$s1 = "UnitInjectLibrary" ascii
		$s2 = "TLoader" fullword ascii
		$s3 = "\\\\.\\SyserDbgMsg" fullword ascii
		$s4 = "\\\\.\\SyserBoot" fullword ascii
		$s5 = "\\signons" ascii
		$s6 = "####@####" ascii
		$s7 = "XX-XX-XX-XX" fullword ascii
		$s8 = "EditSvr" ascii
		$s9 = "_x_X_PASSWORDLIST_X_x_" fullword ascii
		$s10 = "L$_RasDefaultCredentials#0" fullword ascii
		$s11 = "password" nocase ascii

	condition:
		uint16(0)==0x5a4d and 8 of them
}
