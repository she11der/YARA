import "pe"

rule DITEKSHEN_MALWARE_Win_HUNT_Ghostemperor_Remotecontrolpayload : FILE
{
	meta:
		description = "Attempt on hunting GhostEmperor Stage 4 Remote Control Payload"
		author = "ditekSHen"
		id = "d30a2aad-8bd6-5291-a31d-7dade250e57e"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/09/30094337/GhostEmperor_technical-details_PDF_eng.pdf"
		source_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/yara/malware.yar#L8043-L8050"
		license_url = "https://github.com/ditekshen/detection/blob/c37b067259715d4c93ac274a0830c54b355556a1/LICENSE.txt"
		logic_hash = "dabce4e0add0d05b4efd8e7540e4f14767c7b5fab361bd731234dd9dd844c658"
		score = 50
		quality = 75
		tags = "FILE"

	condition:
		uint16(0)==0x5a4d and pe.is_dll() and pe.number_of_exports==2 and pe.exports("1") and pe.exports("__acrt_iob_func")
}
