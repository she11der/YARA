rule SIGNATURE_BASE_Regin_Related_Malware
{
	meta:
		description = "Malware Sample - maybe Regin related"
		author = "Florian Roth (Nextron Systems)"
		id = "9377dd52-244f-5289-a2a3-88b6377b2dd2"
		date = "2015-06-03"
		modified = "2023-12-15"
		reference = "VT Analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/spy_regin_fiveeyes.yar#L343-L366"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		hash = "76c355bfeb859a347e38da89e3d30a6ff1f94229"
		logic_hash = "61ce7a69ab357740158e355455362a4f5fddc67ee60af120733f509e7407216f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "%c%s%c -p %d -e %d -pv -c \"~~[%x] s; .%c%c%s %s /u %s_%d.dmp; q\"" fullword wide
		$s0 = "Software\\Microsoft\\Windows NT\\CurrentVersion\\HotFix" fullword wide
		$s2 = "%x:%x:%x:%x:%x:%x:%x:%x%c" fullword ascii
		$s3 = "disp.dll" fullword ascii
		$s4 = "msvcrtd.dll" fullword ascii
		$s5 = "%d.%d.%d.%d%c" fullword ascii
		$s6 = "%ls_%08x" fullword wide
		$s8 = "d%ls%ls" fullword wide
		$s9 = "Memory location: 0x%p, size 0x%08x" fullword wide

	condition:
		$s1 or 3 of ($s*)
}
