rule SIGNATURE_BASE_Liudoor_Malware_2 : FILE
{
	meta:
		description = "Liudoor Trojan used in Terracotta APT"
		author = "Florian Roth (Nextron Systems)"
		id = "30b9d727-ec77-5ead-80dd-6d442478e78b"
		date = "2015-08-04"
		modified = "2023-12-05"
		reference = "https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/apt_terracotta.yar#L91-L108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "12cc72fb147f2d580f9f9e2a9bdfbec3f7b0e977871a27ccc941cd0b1aaa634c"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "f3fb68b21490ded2ae7327271d3412fbbf9d705c8003a195a705c47c98b43800"
		hash2 = "e42b8385e1aecd89a94a740a2c7cd5ef157b091fabd52cd6f86e47534ca2863e"

	strings:
		$s0 = "svchostdllserver.dll" fullword ascii
		$s1 = "Lpykh~mzCCRv|mplpykCCHvq{phlCC\\jmmzqkIzmlvpqCC" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <100KB and all of them
}
