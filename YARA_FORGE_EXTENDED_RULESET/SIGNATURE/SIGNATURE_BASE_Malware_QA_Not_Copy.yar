rule SIGNATURE_BASE_Malware_QA_Not_Copy : FILE
{
	meta:
		description = "VT Research QA uploaded malware - file not copy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "d618389b-ec80-5ad1-be44-4b1f3e36c07d"
		date = "2016-08-29"
		modified = "2023-12-05"
		reference = "VT Research QA"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/gen_malware_set_qa.yar#L13-L37"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "4001d71101a9c6d4134e7ed4b9b03d34ada62241a668970e21a60d7a23dd7b86"
		score = 80
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "1410f38498567b64a4b984c69fe4f2859421e4ac598b9750d8f703f1d209f836"

	strings:
		$x1 = "U2VydmVyLmV4ZQ==" fullword wide
		$x2 = "\\not copy\\obj\\Debug\\not copy.pdb" ascii
		$x3 = "fuckyou888.ddns.net" fullword wide
		$s1 = "cmd.exe /c ping 0 -n 2 & del \"" fullword wide
		$s2 = "Server.exe" fullword wide
		$s3 = "Execute ERROR" fullword wide
		$s4 = "not copy.exe" fullword wide
		$s5 = "Non HosT" fullword wide
		$s6 = "netsh firewall delete allowedprogram" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <1000KB and (1 of ($x*) or 4 of ($s*))) or (5 of them )
}
