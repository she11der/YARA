rule SIGNATURE_BASE_APT_Malware_Putterpanda_Gen1 : FILE
{
	meta:
		description = "Detects a malware "
		author = "YarGen Rule Generator"
		id = "5e7910e7-3f33-50fb-a87f-bf0bbf8a2797"
		date = "2015-06-03"
		modified = "2023-12-05"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/apt_putterpanda.yar#L110-L131"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "8054195f212017fb17953728a7df34645d81c93fee75300e44f467c6aa5efaff"
		score = 75
		quality = 85
		tags = "FILE"
		super_rule = 1
		hash0 = "bf1d385e637326a63c4d2f253dc211e6a5436b6a"
		hash1 = "76459bcbe072f9c29bb9703bc72c7cd46a692796"
		hash2 = "e105a7a3a011275002aec4b930c722e6a7ef52ad"

	strings:
		$s1 = "%s%duserid=%dthreadid=%dgroupid=%d" fullword ascii
		$s2 = "ssdpsvc.dll" fullword ascii
		$s3 = "Fail %s " fullword ascii
		$s4 = "%s%dpara1=%dpara2=%dpara3=%d" fullword ascii
		$s5 = "LsaServiceInit" fullword ascii
		$s6 = "%-8d Fs %-12s Bs " fullword ascii
		$s7 = "Microsoft DH SChannel Cryptographic Provider" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <1000KB and 5 of them
}
