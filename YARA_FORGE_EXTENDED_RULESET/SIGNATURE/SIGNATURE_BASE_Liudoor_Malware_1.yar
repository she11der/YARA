rule SIGNATURE_BASE_Liudoor_Malware_1 : FILE
{
	meta:
		description = "Liudoor Trojan used in Terracotta APT"
		author = "Florian Roth (Nextron Systems)"
		id = "ebd5833e-1f5c-5166-aaba-d0be64829e6c"
		date = "2015-08-04"
		modified = "2023-12-05"
		reference = "https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/apt_terracotta.yar#L69-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "9ef9fcc5df910e796d8b015396cf37614982ebbf9be6f6a4a8d271d4263a36a9"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "deed6e2a31349253143d4069613905e1dfc3ad4589f6987388de13e33ac187fc"
		hash2 = "4575e7fc8f156d1d499aab5064a4832953cd43795574b4c7b9165cdc92993ce5"
		hash3 = "ad1a507709c75fe93708ce9ca1227c5fefa812997ed9104ff9adfec62a3ec2bb"

	strings:
		$s1 = "svchostdllserver.dll" fullword ascii
		$s2 = "SvcHostDLL: RegisterServiceCtrlHandler %S failed" fullword ascii
		$s3 = "\\nbtstat.exe" ascii
		$s4 = "DataVersionEx" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <150KB and all of them
}
