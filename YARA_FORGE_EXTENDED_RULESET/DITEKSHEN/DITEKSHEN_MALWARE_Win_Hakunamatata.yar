import "pe"

rule DITEKSHEN_MALWARE_Win_Hakunamatata : FILE
{
	meta:
		description = "Detects HakunaMatata ransomware"
		author = "ditekSHen"
		id = "43ca40bb-9eb6-558e-977d-f1fff5659565"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L10080-L10100"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "b49705845e5440c3c1e47e196592ca2b31319d1af5265f2f954d3367e3d39d5c"
		score = 75
		quality = 75
		tags = "FILE"

	strings:
		$s1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s2 = "(?:[13]{1}[a-km-zA-HJ-NP-Z1-9]{26,33}|bc1[a-z0-9]{39,59})" wide
		$s3 = "<RSAKeyValue><Modulus>" wide
		$s4 = "HAKUNA MATATA" ascii wide
		$s5 = "EXCEPTIONAL_FILE" ascii
		$s6 = "TRIPLE_ENCRYPT" ascii
		$s7 = "FULL_ENCRYPT" ascii
		$s8 = "TARGETED_EXTENSIONS" ascii
		$s9 = "CHANGE_PROCESS_NAME" ascii
		$s10 = "KILL_APPS_ENCRYPT_AGAIN" ascii
		$s11 = "<ALL_DRIVES>b__" ascii
		$s12 = "dataToEncrypt" ascii
		$s13 = "<RECURSIVE_DIRECTORY_LOOK>" ascii

	condition:
		uint16(0)==0x5a4d and 5 of them
}
