import "pe"

rule DITEKSHEN_MALWARE_Win_Farfli : FILE
{
	meta:
		description = "Detects Farfli backdoor"
		author = "ditekSHen"
		id = "4c3c86f4-5493-5e8a-9618-b0c3d55e2b86"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L4241-L4253"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "cb1856b32c66d6d070b8ec2d9feea25d6d6748057ceaa342be2ddc589f9a89d6"
		score = 75
		quality = 50
		tags = "FILE"

	strings:
		$s1 = "%ProgramFiles%\\Google\\" fullword ascii
		$s2 = "%s\\%d.bak" fullword ascii
		$s3 = "%s Win7" fullword ascii
		$s4 = "%s:%d:%s" fullword ascii
		$s5 = "C:\\2.txt" fullword ascii

	condition:
		uint16(0)==0x5a4d and all of them
}
