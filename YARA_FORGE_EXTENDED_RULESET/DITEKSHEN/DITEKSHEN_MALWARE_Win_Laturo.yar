import "pe"

rule DITEKSHEN_MALWARE_Win_Laturo : FILE
{
	meta:
		description = "Laturo information stealer payload"
		author = "ditekSHen"
		id = "221a1ee8-e1ae-558c-919c-e3f55c1500f0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L3-L26"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "bfb0c5676c926f58a4395a56dad09b37e8ac1cf0bf6b5521767c16698644b73a"
		score = 75
		quality = 61
		tags = "FILE"
		clamav_sig = "MALWARE.Win.Trojan.Laturo"

	strings:
		$str1 = "cmd.exe /c ping 127.0.0.1" ascii wide
		$str2 = "cmd.exe /c start" ascii wide
		$str3 = "\\RapidLoader\\" ascii
		$str4 = "loader/gate.php" ascii wide
		$str5 = "Hwid:" ascii wide
		$str6 = "Special:" ascii wide
		$str7 = "logs=%s" ascii
		$data1 = "cookies.%u.txt" nocase ascii wide
		$data2 = "passwords.%u.txt" nocase ascii wide
		$data3 = "credentials.%u.txt" nocase ascii wide
		$data4 = "cards.%u.txt" nocase ascii wide
		$data5 = "autofill.%u.txt" nocase ascii wide
		$data6 = "loginusers.vdf" ascii wide
		$data7 = "screenshot.bmp" nocase ascii wide
		$data8 = "webcam.bmp" nocase ascii wide

	condition:
		uint16(0)==0x5a4d and 5 of ($str*) and 1 of ($data*)
}
