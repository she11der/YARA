import "pe"

rule DITEKSHEN_MALWARE_Win_Dlagent08 : FILE
{
	meta:
		description = "Detects known downloader agent downloading encoded binaries in patches"
		author = "ditekSHen"
		id = "e3450f93-7c57-5386-a901-bc5e710657a4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L4965-L4975"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "0238c13b00e5778ef216b4e8576c321803da6e269c96c3051b9cc45a3ac6e567"
		score = 75
		quality = 75
		tags = "FILE"
		snort2_sid = "920122"
		snort3_sid = "920119"

	strings:
		$pat = /\/base\/[A-F0-9]{32}\.html/ ascii wide

	condition:
		uint16(0)==0x5a4d and $pat and #pat>1
}
