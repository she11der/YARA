import "pe"

rule DITEKSHEN_MALWARE_Win_Hakunamatata_Builder : FILE
{
	meta:
		description = "Detects HakunaMatata ransomware builder"
		author = "ditekSHen"
		id = "dbf3490f-418c-5d3b-9f9e-e9fb29d8b652"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L10102-L10120"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "ac258851de38504cf63ba51fd06f8a9a3dfbe0096d199ba702e9763b5ecc43e4"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$s1 = "ENCRYPT FILES IN PROCESS" wide
		$s2 = "#TARGET_FILES" ascii wide
		$s3 = "HAKUNA MATATA" ascii wide nocase
		$s4 = "#PRIVATE_KEY" ascii wide
		$s5 = "/target:winexe /platform:anycpu /optimize+" wide
		$s6 = "/win32icon:" fullword wide
		$s7 = "SkippedFolders" ascii
		$s8 = "RECURSIVE_DIRECTORY_LOOK(" ascii
		$s9 = "DRAW_WALLPAPER(" ascii
		$s10 = "startupKey.SetValue(MESSAGE_FILE.Split('.')[0], executablePath);" ascii
		$s11 = /\\obj\\(Debug|Release)\\Hakuna\sMatata\.pdb/ ascii

	condition:
		uint16(0)==0x5a4d and 5 of them
}
