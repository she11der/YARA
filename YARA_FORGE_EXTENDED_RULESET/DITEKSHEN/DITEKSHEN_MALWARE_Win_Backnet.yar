import "pe"

rule DITEKSHEN_MALWARE_Win_Backnet : FILE
{
	meta:
		description = "BackNet payload"
		author = "ditekSHen"
		id = "c53ef72f-4957-5ddb-b096-dcdb69cf900d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/yara/malware.yar#L369-L386"
		license_url = "https://github.com/ditekshen/detection/blob/5fc671f9f4a5847c929d488dc74f8b671529b254/LICENSE.txt"
		logic_hash = "c276f2b809caad680455fc4ca0a021887d4ff2c9114f05737542a1d3c5cca848"
		score = 75
		quality = 75
		tags = "FILE"
		clamav_sig = "MALWARE.Win.Trojan.BackNet"

	strings:
		$s1 = "Slave.Commands." fullword ascii
		$s2 = "StartKeylogger" fullword ascii
		$s3 = "StopKeylogger" fullword ascii
		$s4 = "KeyLoggerCommand" fullword ascii
		$s5 = "get_keyLoggerManager" fullword ascii
		$s6 = "get_IgnoreMutex" fullword ascii
		$s7 = "ListProcesses" fullword ascii
		$s8 = "downloadurl" fullword wide
		$pdb = "\\BackNet-master\\Slave\\obj\\Release\\Slave.pdb" ascii

	condition:
		uint16(0)==0x5a4d and ($pdb or all of ($s*))
}
