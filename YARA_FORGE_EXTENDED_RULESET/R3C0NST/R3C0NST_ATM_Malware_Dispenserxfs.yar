import "hash"

rule R3C0NST_ATM_Malware_Dispenserxfs : FILE
{
	meta:
		description = "No description has been set in the source file - R3c0nst"
		author = "Frank Boldewin"
		id = "52b1aa57-283b-54d7-bd1b-fb5da5f8d269"
		date = "2019-02-28"
		modified = "2019-02-28"
		reference = "https://github.com/fboldewin/YARA-rules/"
		source_url = "https://github.com/fboldewin/YARA-rules//blob/54e9e6899b258b72074b2b4db6909257683240c2/ATM.Malware.DispenserXFS.yar#L3-L13"
		license_url = "N/A"
		logic_hash = "0e588e2ba03d5eb750183600cce278e791a71f86fbf933ba9d7fda352bd37e2f"
		score = 75
		quality = 59
		tags = "FILE"

	strings:
		$Code_Bytes = { 68 FF FF 00 00 68 60 EA 00 00 6A 10 }
		$XFSKILL = "injected mxsfs killer into" nocase ascii wide
		$PDB = "C:\\_bkittest\\dispenser\\Release_noToken\\dispenserXFS.pdb" nocase ascii wide

	condition:
		(hash.sha256(0, filesize )=="867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a") or ( uint16(0)==0x5A4D and 1 of them )
}
