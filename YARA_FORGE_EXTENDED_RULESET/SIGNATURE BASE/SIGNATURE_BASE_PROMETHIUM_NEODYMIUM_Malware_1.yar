rule SIGNATURE_BASE_PROMETHIUM_NEODYMIUM_Malware_1 : FILE
{
	meta:
		description = "Detects PROMETHIUM and NEODYMIUM malware"
		author = "Florian Roth (Nextron Systems)"
		id = "21e858b1-2cfa-5757-96f0-7c44a5da6898"
		date = "2016-12-14"
		modified = "2023-12-05"
		reference = "https://goo.gl/8abDE6"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/apt_promethium_neodymium.yar#L10-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "143e52eedc5c3be9bbf0f916b232de26e4ed5c7e81e3f77cae70e6af84d31de1"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e12031da58c0b08e8b610c3786ca2b66fcfea8ddc9ac558d08a29fd27e95a3e7"

	strings:
		$s1 = "c:\\Windows\\system32\\syswindxr32.dll" fullword wide
		$s2 = "c:\\windows\\temp\\TrueCrypt-Setup-7.1a-tamindir.exe" fullword wide
		$s3 = "%s\\ssleay32.dll" fullword wide
		$s4 = "%s\\libeay32.dll" fullword wide
		$s5 = "%s\\fprot32.exe" fullword wide

	condition:
		( uint16(0)==0x5a4d and filesize <10000KB and 3 of them ) or ( all of them )
}
