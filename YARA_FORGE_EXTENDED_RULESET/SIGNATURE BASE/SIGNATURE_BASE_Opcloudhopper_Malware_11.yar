rule SIGNATURE_BASE_Opcloudhopper_Malware_11 : FILE
{
	meta:
		description = "Detects malware from Operation Cloud Hopper"
		author = "Florian Roth (Nextron Systems)"
		id = "18bd2fa9-7eca-5dbc-8e79-953800d5bb0a"
		date = "2017-04-03"
		modified = "2023-12-05"
		reference = "https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/yara/apt_op_cloudhopper.yar#L224-L240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/995df52f47284d130b8cbf57d08c31e927e44c09/LICENSE"
		logic_hash = "7935d3aeef0d4c94a00dd44942a1ba97d0c9fce848914ebc9c59d9f8e9f51599"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a80f6c57f772f20d63021c8971a280c19e8eafe7cc7088344c598d84026dda15"

	strings:
		$x1 = "IOGVWDWCXZVRHTE" fullword ascii
		$op1 = { c9 c3 56 6a 00 8b f1 6a 64 e8 dd 34 00 00 c7 06 }
		$op2 = { 68 38 00 41 00 68 34 00 41 00 e8 d3 }

	condition:
		( uint16(0)==0x5a4d and filesize <200KB and 2 of them )
}
