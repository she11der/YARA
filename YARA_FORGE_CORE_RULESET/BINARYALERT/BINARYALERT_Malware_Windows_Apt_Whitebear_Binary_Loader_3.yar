rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_3
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "bdcc0c30-3aa7-5c92-8205-9b360d10ac59"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_3.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "b099b82acb860d9a9a571515024b35f0"
		logic_hash = "955aad2d72407baa7fb71e04b51557649a6f91633f5bdb1a8792e328a1587d23"
		score = 75
		quality = 80
		tags = ""

	strings:
		$c1 = "{531511FA-190D-5D85-8A4A-279F2F592CC7}" wide ascii
		$c2 = "IsLoaderAlreadyWork" wide ascii
		$c3 = "\\\\.\\pipe\\Winsock2\\CatalogChangeListener-%03x%01x-%01x" wide ascii
		$c4 = "\\\\.\\pipe\\Winsock2\\CatalogChangeListener-%02x%02x-%01x" wide ascii

	condition:
		all of ($c*)
}
