rule BINARYALERT_Malware_Macos_Bella
{
	meta:
		description = "Bella is a pure python post-exploitation data mining tool & remote administration tool for macOS."
		author = "@mimeframe"
		id = "ca4ab508-8c97-5307-9aaf-db10cfd6ab35"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/Trietptm-on-Security/Bella"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_bella.yara#L1-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "b9c063b5ec8604958d3417ec8640da4314ebcf60ee55413a2f6fa8d138311614"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Verified! [2FV Enabled] Account ->" wide ascii
		$a2 = "There is no root shell to perform this command. See [rooter] manual entry." wide ascii
		$a3 = "Attempt to escalate Bella to root through a variety of attack vectors." wide ascii
		$a4 = "BELLA IS NOW RUNNING. CONNECT TO BELLA FROM THE CONTROL CENTER." wide ascii
		$b1 = "user_pass_phish" fullword wide ascii
		$b2 = "bella_info" fullword wide ascii
		$b3 = "get_root" fullword wide ascii
		$c1 = "Please specify a bella server." wide ascii
		$c2 = "What port should Bella connect on [Default is 4545]:" wide ascii

	condition:
		any of ($a*) or all of ($b*) or all of ($c*)
}
