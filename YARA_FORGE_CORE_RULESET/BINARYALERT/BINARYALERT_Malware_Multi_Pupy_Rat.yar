rule BINARYALERT_Malware_Multi_Pupy_Rat
{
	meta:
		description = "pupy - opensource cross platform rat and post-exploitation tool"
		author = "@mimeframe"
		id = "b26deb19-85b2-5d39-9ff2-0ab9017f3263"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/n1nj4sec/pupy"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/multi/malware_multi_pupy_rat.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "bb5d1e7f2aea94dc41efe75690ae31409e8f6305aa6c4ec0cd46922ee8fb7241"
		score = 75
		quality = 74
		tags = ""

	strings:
		$a1 = "dumping lsa secrets" nocase wide ascii
		$a2 = "dumping cached domain passwords" nocase wide ascii
		$a3 = "the keylogger is already started" nocase wide ascii
		$a4 = "pupyutils.dns" wide ascii
		$a5 = "pupwinutils.security" wide ascii
		$a6 = "-PUPY_CONFIG_COMES_HERE-" wide ascii

	condition:
		3 of ($a*)
}
