rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_1
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "6b5709fd-a923-56b6-98ab-ae036f9d04c3"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_1.yara#L1-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "b099b82acb860d9a9a571515024b35f0"
		logic_hash = "f6706c66a378b80d3cedf118a812d8add60e12b44402a30d941d08ff30c7ab1c"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "### PE STORAGE ###" wide ascii
		$a2 = "### CRYPTO 0 ###" wide ascii
		$a3 = "### EXTERNAL STORAGE ###" wide ascii
		$a4 = "### CRYPTO 1 ###" wide ascii
		$a5 = "### QUEUES ###" wide ascii
		$a6 = "### TRANSPORT ###" wide ascii
		$a7 = "### EXECUTION SUBSYSTEM ###" wide ascii
		$a8 = "### AUTORUN MANAGER ###" wide ascii
		$a9 = "### INJECT MANAGER ###" wide ascii
		$a10 = "### LOCAL TRANSPORT MANAGER ###" wide ascii

	condition:
		6 of ($a*)
}
