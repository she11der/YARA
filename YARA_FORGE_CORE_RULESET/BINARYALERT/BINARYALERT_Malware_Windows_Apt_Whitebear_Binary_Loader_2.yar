rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_2
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "d97b7fe1-7ff3-5cc0-9085-140ed523421f"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_2.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "06bd89448a10aa5c2f4ca46b4709a879"
		logic_hash = "9bb7fc3b3bf7f91efbba128895bb61b5a1bbdb6625d84836956de5e884ae3fe1"
		score = 75
		quality = 80
		tags = ""

	strings:
		$b1 = "i cunt waiting anymore #%d" wide ascii
		$b2 = "lights aint turnt off with #%d" wide ascii
		$b3 = "Not find process" wide ascii
		$b4 = "CMessageProcessingSystem::Receive_TAKE_NOP" wide ascii
		$b5 = "CMessageProcessingSystem::Receive_TAKE_CAN_NOT_WORK" wide ascii

	condition:
		3 of ($b*)
}
