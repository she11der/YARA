rule SIGNATURE_BASE_SUSP_Jdniexploit_Error_Indicators_Dec21_1
{
	meta:
		description = "Detects error messages related to JDNI usage in log files that can indicate a Log4Shell / Log4j exploitation"
		author = "Florian Roth (Nextron Systems)"
		id = "68bcf043-58b4-54a9-b024-64871b5d535f"
		date = "2021-12-10"
		modified = "2023-06-23"
		reference = "https://twitter.com/marcioalm/status/1470361495405875200?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/expl_log4j_cve_2021_44228.yar#L213-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "2ab98814b2ed66b0bda875fecc0b09db82035d7edcdb0af65f815817ec8c6cc8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "FATAL log4j - Message: BadAttributeValueException: "

	condition:
		1 of them
}
