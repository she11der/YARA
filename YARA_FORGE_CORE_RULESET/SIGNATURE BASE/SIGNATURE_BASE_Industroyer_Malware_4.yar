rule SIGNATURE_BASE_Industroyer_Malware_4 : FILE
{
	meta:
		description = "Detects Industroyer related malware"
		author = "Florian Roth (Nextron Systems)"
		id = "f197d2a5-eecb-51ed-b991-7643efb3f749"
		date = "2017-06-13"
		modified = "2023-12-05"
		reference = "https://goo.gl/x81cSy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/apt_industroyer.yar#L117-L134"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "cb850445eaf3e1a6c9a9d6c453ed0f6729a95a671a01ce8fbaddf15599e4f2ba"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "21c1fdd6cfd8ec3ffe3e922f944424b543643dbdab99fa731556f8805b0d5561"

	strings:
		$s1 = "haslo.dat" fullword wide
		$s2 = "defragsvc" fullword ascii
		$a1 = { 00 2E 00 64 00 61 00 74 00 00 00 43 72 61 73 68 00 00 00 }

	condition:
		( uint16(0)==0x5a4d and filesize <200KB and all of ($s*) or $a1)
}
