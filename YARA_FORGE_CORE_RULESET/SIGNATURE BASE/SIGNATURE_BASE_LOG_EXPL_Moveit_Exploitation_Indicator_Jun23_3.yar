rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_3
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit DMZ Web API logs"
		author = "Nasreddine Bencherchali"
		id = "113a501f-d9ed-51fd-82cd-ccb6f02833bd"
		date = "2023-06-13"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/yara/vuln_moveit_0day_jun23.yar#L81-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/1985dee16d61c60c9970e213ad2ef57039eaa1d5/LICENSE"
		logic_hash = "2eaa06c31687c6368f036a705fdc1b1c42355f19c098ae764a998039cc4aebb5"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "TargetInvocationException" ascii
		$s2 = "MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream" ascii

	condition:
		all of ($s*)
}
