rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Icon_Jun23
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Icon File; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "faaa507f-8478-5412-be86-4cae7fe28d21"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L33-L49"
		license_url = "N/A"
		logic_hash = "1cf552c4627073d13832cf0ac602a610e0919af9e9a197aa07fef5d6a414644b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "IconResource=C:\\Windows\\system32\\SHELL32.dll,7" ascii

	condition:
		all of ($s_*)
}
